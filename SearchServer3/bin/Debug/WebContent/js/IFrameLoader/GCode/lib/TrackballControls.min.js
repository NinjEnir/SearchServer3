THREE.TrackballControls=function(e,t){function n(e){r.enabled&&(window.removeEventListener("keydown",n),u=h,h===d.NONE&&(e.keyCode!==r.keys[d.ROTATE]||r.noRotate?e.keyCode!==r.keys[d.ZOOM]||r.noZoom?e.keyCode!==r.keys[d.PAN]||r.noPan||(h=d.PAN):h=d.ZOOM:h=d.ROTATE))}function o(){r.enabled&&(h=u,window.addEventListener("keydown",n,!1))}function i(e){r.enabled&&(e.preventDefault(),e.stopPropagation(),h===d.NONE&&(h=e.button),h!==d.ROTATE||r.noRotate?h!==d.ZOOM||r.noZoom?h!==d.PAN||r.noPan||(v=y=r.getMouseOnScreen(e.clientX,e.clientY)):f=g=r.getMouseOnScreen(e.clientX,e.clientY):p=E=r.getMouseProjectionOnBall(e.clientX,e.clientY),document.addEventListener("mousemove",s,!1),document.addEventListener("mouseup",a,!1))}function s(e){r.enabled&&(h!==d.ROTATE||r.noRotate?h!==d.ZOOM||r.noZoom?h!==d.PAN||r.noPan||(y=r.getMouseOnScreen(e.clientX,e.clientY)):g=r.getMouseOnScreen(e.clientX,e.clientY):E=r.getMouseProjectionOnBall(e.clientX,e.clientY))}function a(e){r.enabled&&(e.preventDefault(),e.stopPropagation(),h=d.NONE,document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",a))}function c(e){if(r.enabled){e.preventDefault(),e.stopPropagation();var t=0;e.wheelDelta?t=e.wheelDelta/40:e.detail&&(t=-e.detail/3),f.y+=1/t*.05}}THREE.EventTarget.call(this);var r=this,d={NONE:-1,ROTATE:0,ZOOM:1,PAN:2};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={width:0,height:0,offsetLeft:0,offsetTop:0},this.radius=(this.screen.width+this.screen.height)/4,this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var l=new THREE.Vector3,h=d.NONE,u=d.NONE,m=new THREE.Vector3,p=new THREE.Vector3,E=new THREE.Vector3,f=new THREE.Vector2,g=new THREE.Vector2,v=new THREE.Vector2,y=new THREE.Vector2,w={type:"change"};this.handleResize=function(){this.screen.width=window.innerWidth,this.screen.height=window.innerHeight,this.screen.offsetLeft=0,this.screen.offsetTop=0,this.radius=(this.screen.width+this.screen.height)/4},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)},this.getMouseOnScreen=function(e,t){return new THREE.Vector2((e-r.screen.offsetLeft)/r.radius*.5,(t-r.screen.offsetTop)/r.radius*.5)},this.getMouseProjectionOnBall=function(e,t){var n=new THREE.Vector3((e-.5*r.screen.width-r.screen.offsetLeft)/r.radius,(.5*r.screen.height+r.screen.offsetTop-t)/r.radius,0),o=n.length();o>1?n.normalize():n.z=Math.sqrt(1-o*o),m.copy(r.object.position).subSelf(r.target);var i=r.object.up.clone().setLength(n.y);return i.addSelf(r.object.up.clone().crossSelf(m).setLength(n.x)),i.addSelf(m.setLength(n.z)),i},this.rotateCamera=function(){var e=Math.acos(p.dot(E)/p.length()/E.length());if(e){var t=(new THREE.Vector3).cross(p,E).normalize(),n=new THREE.Quaternion;e*=r.rotateSpeed,n.setFromAxisAngle(t,-e),n.multiplyVector3(m),n.multiplyVector3(r.object.up),n.multiplyVector3(E),r.staticMoving?p.copy(E):(n.setFromAxisAngle(t,e*(r.dynamicDampingFactor-1)),n.multiplyVector3(p))}},this.zoomCamera=function(){var e=1+(g.y-f.y)*r.zoomSpeed;1!==e&&e>0&&(m.multiplyScalar(e),r.staticMoving?f.copy(g):f.y+=(g.y-f.y)*this.dynamicDampingFactor)},this.panCamera=function(){var e=y.clone().subSelf(v);if(e.lengthSq()){e.multiplyScalar(m.length()*r.panSpeed);var t=m.clone().crossSelf(r.object.up).setLength(e.x);t.addSelf(r.object.up.clone().setLength(e.y)),r.object.position.addSelf(t),r.target.addSelf(t),r.staticMoving?v=y:v.addSelf(e.sub(y,v).multiplyScalar(r.dynamicDampingFactor))}},this.checkDistances=function(){r.noZoom&&r.noPan||(r.object.position.lengthSq()>r.maxDistance*r.maxDistance&&r.object.position.setLength(r.maxDistance),m.lengthSq()<r.minDistance*r.minDistance&&r.object.position.add(r.target,m.setLength(r.minDistance)))},this.update=function(){m.copy(r.object.position).subSelf(r.target),r.noRotate||r.rotateCamera(),r.noZoom||r.zoomCamera(),r.noPan||r.panCamera(),r.object.position.add(r.target,m),r.checkDistances(),r.object.lookAt(r.target),l.distanceToSquared(r.object.position)>0&&(r.dispatchEvent(w),l.copy(r.object.position))},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",i,!1),this.domElement.addEventListener("DOMMouseScroll",c,!1),this.domElement.addEventListener("mousewheel",c,!1),window.addEventListener("keydown",n,!1),window.addEventListener("keyup",o,!1),this.handleResize()};